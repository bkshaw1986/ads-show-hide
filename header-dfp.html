<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Conditional Ads Page</title>

  <!-- GPT (Google Publisher Tag) must be first in header -->
  <script async src="https://securepubads.g.doubleclick.net/tag/js/gpt.js"></script>
  <script>
    window.googletag = window.googletag || { cmd: [] };

    googletag.cmd.push(function() {
      googletag.pubads().collapseEmptyDivs(true);
      googletag.pubads().enableSingleRequest();
      googletag.enableServices();

      // Define slots (but won't be displayed unless .pl returns 1)
      window.slot_top = googletag.defineSlot('/1234567/homepage_leaderboard', [[728,90],[970,90]], 'div-gpt-ad-top')
                        .addService(googletag.pubads());

      window.slot_sidebar = googletag.defineSlot('/1234567/sidebar_box', [300,250], 'div-gpt-ad-side')
                             .addService(googletag.pubads());

      window.slot_incontent = googletag.defineSlot('/1234567/incontent', [336,280], 'div-gpt-ad-mid')
                              .addService(googletag.pubads());
    });
  </script>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
  <div class="container my-5">
    <h3 class="mb-4">Conditional Ads Example</h3>
    <div id="adsArea"></div>
    <div id="noAdsMsg" class="alert alert-warning d-none">No ads for this session.</div>
  </div>

  <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
  <script>
    $(function() {
      var checkUrl = "https://dev.123greetings.com/cgi-bin/test/check_pro.pl";

      $.ajax({
        url: checkUrl,
        method: "GET",
        dataType: "json", // .pl returns "0" or "1"
		timeout: 8000,
        success: function(resp) {
          resp = $.trim(resp);
          if (resp === "1") {
            // Inject ad containers only if allowed
            $("#adsArea").html(`
              <div id="div-gpt-ad-top" style="margin-bottom:20px;"></div>
              <div class="row">
                <div class="col-md-8">
                  <div id="div-gpt-ad-mid" style="margin-bottom:20px;"></div>
                  <p>Some sample content here...</p>
                </div>
                <div class="col-md-4">
                  <div id="div-gpt-ad-side"></div>
                </div>
              </div>
            `);

            googletag.cmd.push(function() {
              googletag.display("div-gpt-ad-top");
              googletag.display("div-gpt-ad-mid");
              googletag.display("div-gpt-ad-side");
            });
          } else {
            $("#noAdsMsg").removeClass("d-none");
          }
        },
        error: function() {
          $("#noAdsMsg").removeClass("d-none").text("Error checking ads eligibility.");
        }
      });
    });
  </script>
</body>
</html>