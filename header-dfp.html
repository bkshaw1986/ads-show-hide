<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Simple Ads Control</title>
  <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
</head>
<body>
  <h3>My Page with Ads</h3>

  <!-- Example ad containers -->
  <div id="ad1">Ad Slot 1</div>
  <div id="ad2">Ad Slot 2</div>
  <div id="ad3">Ad Slot 3</div>

  <script>
    // simple cookie helpers
    function setCookie(name, value, days) {
      var d = new Date();
      d.setTime(d.getTime() + (days*24*60*60*1000));
      document.cookie = name + "=" + value + ";expires=" + d.toUTCString() + ";path=/";
    }

    function getCookie(name) {
      var match = document.cookie.match(new RegExp('(^| )' + name + '=([^;]+)'));
      if (match) return match[2];
      return null;
    }

    // check ads permission from cookie
    function canShowAds() {
      return getCookie("ads_disabled") !== "1";
    }

    $(function() {
      // Call your .pl file once
      $.ajax({
        url: "https://dev.123greetings.com/cgi-bin/test/check_pro.pl",
        method: "GET",
        dataType: "json",
		timeout: 5000,
        success: function(resp) {
          resp = $.trim(resp);
		  
          if (resp == 0) {
            setCookie("ads_disabled", "1", 1); // disable ads for 1 day
          } else {
            setCookie("ads_disabled", "0", 1); // enable ads
          }

          // Now check cookie for each ad
          if (!canShowAds()) {
            $("#ad1, #ad2, #ad3").remove(); // remove ad blocks
          } else {
            // here you can load your ad scripts
            $("#ad1").text("Real Ad 1 loaded");
            $("#ad2").text("Real Ad 2 loaded");
            $("#ad3").text("Real Ad 3 loaded");
          }
        },
        error: function() {
          // if API fails, treat as disabled (optional)
          setCookie("ads_disabled", "1", 1);
          $("#ad1, #ad2, #ad3").remove();
        }
      });
    });
  </script>
</body>
</html>