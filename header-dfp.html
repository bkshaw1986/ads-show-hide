<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Conditional Ads Page</title>

  <!-- 1) Load Google Publisher Tag (DFP / GPT) first -->
  <script async src="https://securepubads.g.doubleclick.net/tag/js/gpt.js"></script>

  <script>
    window.googletag = window.googletag || { cmd: [] };

    googletag.cmd.push(function() {
      // Basic config
      googletag.pubads().collapseEmptyDivs(true);
      googletag.pubads().enableSingleRequest();
      googletag.enableServices();

      // Define slots (replace with your real ad unit IDs)
      window.slot_top = googletag.defineSlot('/1234567/homepage_leaderboard', [[728,90],[970,90]], 'div-gpt-ad-top')
                        .addService(googletag.pubads());

      window.slot_sidebar = googletag.defineSlot('/1234567/sidebar_box', [300,250], 'div-gpt-ad-side')
                             .addService(googletag.pubads());

      window.slot_incontent = googletag.defineSlot('/1234567/incontent', [336,280], 'div-gpt-ad-mid')
                              .addService(googletag.pubads());
    });
  </script>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    .ad-placeholder {
      border: 1px dashed #ddd;
      min-height: 90px;
      display:flex;
      align-items:center;
      justify-content:center;
      color:#666;
      background:#fafafa;
      margin-bottom:1rem;
    }
    .d-none { display: none !important; }
  </style>
</head>
<body>
  <div class="container my-5">
    <h3 class="mb-4">Page with Conditional Ads (0/1 Response)</h3>

    <!-- Ads area -->
    <div id="adsArea">
      <div id="div-gpt-ad-top" class="ad-placeholder d-none">
        Top leaderboard ad (hidden)
      </div>

      <div class="row">
        <div class="col-md-8">
          <div id="div-gpt-ad-mid" class="ad-placeholder d-none">
            In-content ad (hidden)
          </div>
          <p>
            Sample content where in-content ad would appear. Replace with your real page content.
          </p>
        </div>
        <div class="col-md-4">
          <div id="div-gpt-ad-side" class="ad-placeholder d-none">
            Sidebar ad (hidden)
          </div>
        </div>
      </div>
    </div>

    <!-- No ads message -->
    <div id="noAdsMsg" class="alert alert-warning d-none">
      Ads are not enabled for this session.
    </div>
  </div>

  <!-- jQuery -->
  <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>

  <script>
    $(function() {
      var checkUrl = "https://dev.123greetings.com/cgi-bin/test/check_pro.pl";

      function showNoAds(reason) {
        $('#noAdsMsg').removeClass('d-none').text('Ads disabled: ' + reason);
      }

      function enableAdsAndFetch() {
        $('#div-gpt-ad-top, #div-gpt-ad-mid, #div-gpt-ad-side').removeClass('d-none');

        googletag.cmd.push(function() {
          googletag.display('div-gpt-ad-top');
          googletag.display('div-gpt-ad-mid');
          googletag.display('div-gpt-ad-side');
        });
      }

      $.ajax({
        url: checkUrl,
        method: 'GET',
        dataType: 'text',   // <-- treat as plain text
        timeout: 8000,
        success: function(resp) {
          resp = $.trim(resp); // remove whitespace/newlines
          if (resp === "1") {
            enableAdsAndFetch();
          } else {
            showNoAds('check returned 0');
          }
        },
        error: function(xhr, status, err) {
          showNoAds('error: ' + (status || 'unknown'));
        }
      });
    });
  </script>
</body>
</html>